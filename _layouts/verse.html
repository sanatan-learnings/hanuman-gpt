---
layout: default
---
{% assign lang = page.lang | default: "en" %}
{% assign t = site.data.translations.en %}
{% assign t_en = site.data.translations.en %}
{% assign t_hi = site.data.translations.hi %}

<article class="verse-container">
    <nav class="verse-nav">
        {% if page.previous_verse %}
        <a href="{{ page.previous_verse | relative_url }}?lang={{ lang }}" class="nav-button prev" title="{{ t.nav.previous }} (Left arrow)">
            ‚Üê <span data-lang="en">{{ t_en.nav.previous }}</span><span data-lang="hi">{{ t_hi.nav.previous }}</span>
        </a>
        {% else %}
        <span class="nav-button prev disabled">‚Üê <span data-lang="en">{{ t_en.nav.previous }}</span><span data-lang="hi">{{ t_hi.nav.previous }}</span></span>
        {% endif %}

        <a href="{{ '/' | relative_url }}?lang={{ lang }}" class="nav-button home" title="{{ t.nav.home }}">
            ‚ò∞ <span data-lang="en">{{ t_en.nav.home }}</span><span data-lang="hi">{{ t_hi.nav.home }}</span>
        </a>

        {% if page.next_verse %}
        <a href="{{ page.next_verse | relative_url }}?lang={{ lang }}" class="nav-button next" title="{{ t.nav.next }} (Right arrow)">
            <span data-lang="en">{{ t_en.nav.next }}</span><span data-lang="hi">{{ t_hi.nav.next }}</span> ‚Üí
        </a>
        {% else %}
        <span class="nav-button next disabled"><span data-lang="en">{{ t_en.nav.next }}</span><span data-lang="hi">{{ t_hi.nav.next }}</span> ‚Üí</span>
        {% endif %}
    </nav>

    {% comment %} Theme switcher - only show for collections with multiple themes {% endcomment %}
    {% assign current_collection = page.collection_key %}
    {% if current_collection and site.data.themes.theme_switcher_enabled contains current_collection %}
        {% assign collection_themes = site.data.themes[current_collection].available_themes %}
        <div class="verse-theme-switcher">
            <label for="themeSelect">üé® <span data-lang="en">Image Theme</span><span data-lang="hi">‡§ö‡§ø‡§§‡•ç‡§∞ ‡§•‡•Ä‡§Æ</span>:</label>
            <select id="themeSelect" onchange="switchTheme(this.value)">
                {% for theme_data in collection_themes %}
                    {% assign theme_key = theme_data[0] %}
                    {% assign theme = theme_data[1] %}
                    <option value="{{ theme_key }}"
                            {% if theme.default %}selected{% endif %}>
                        {{ theme.name_en }}
                    </option>
                {% endfor %}
            </select>
        </div>
    {% endif %}

    <div class="verse-content">
        <h1><span data-lang="en">{{ page.title_en | default: page.title }}</span><span data-lang="hi">{{ page.title_hi | default: page.title }}</span></h1>

        {% if page.image %}
        <div class="verse-image-container">
            <img src="{{ page.image | relative_url }}" alt="{{ page.title_en | default: page.title }}" class="verse-image">
        </div>
        {% endif %}

        <h2><span data-lang="en">{{ t_en.sections.devanagari }}</span><span data-lang="hi">{{ t_hi.sections.devanagari }}</span></h2>
        <pre>{{ page.devanagari }}</pre>

        <div data-lang="en">
            <h2>{{ t_en.sections.transliteration }}</h2>
            <pre>{{ page.transliteration }}</pre>
        </div>

        {% assign collection = page.collection_key | default: "hanuman-chalisa" %}

        {% if collection == "hanuman-chalisa" or collection == "sundar-kaand" or collection == "sankat-mochan-hanumanashtak" %}
        <h2><span data-lang="en">{{ t_en.sections.pronunciation }}</span><span data-lang="hi">{{ t_hi.sections.pronunciation }}</span></h2>
        {% assign audio_base = page.path | split: "/" | last | split: "." | first %}
        {% assign audio_full = "/audio/" | append: collection | append: "/" | append: audio_base | append: "_full.mp3" %}
        {% assign audio_slow = "/audio/" | append: collection | append: "/" | append: audio_base | append: "_slow.mp3" %}

        <div class="audio-player-container">
            <p><strong><span data-lang="en">{{ t_en.labels.audio_recitation }}</span><span data-lang="hi">{{ t_hi.labels.audio_recitation }}</span>:</strong></p>
            <div class="audio-players">
                <div class="audio-player">
                    <label>üéµ <span data-lang="en">Full Speed</span><span data-lang="hi">‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ó‡§§‡§ø</span>:</label>
                    <audio controls preload="metadata">
                        <source src="{{ audio_full | relative_url }}" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                </div>
                <div class="audio-player">
                    <label>üê¢ <span data-lang="en">Slow Speed (Learning)</span><span data-lang="hi">‡§ß‡•Ä‡§Æ‡•Ä ‡§ó‡§§‡§ø (‡§∏‡•Ä‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è)</span>:</label>
                    <audio controls preload="metadata">
                        <source src="{{ audio_slow | relative_url }}" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                </div>
            </div>
        </div>
        <p><span data-lang="en">{{ t_en.labels.audio_description }}</span><span data-lang="hi">{{ t_hi.labels.audio_description }}</span></p>
        {% endif %}

        <div data-lang="en">
            {% if page.phonetic_notes %}
            <p><strong>{{ t_en.labels.phonetic_breakdown }}:</strong></p>
            <p>{{ t_en.labels.key_words }}:</p>
            <ul>
            {% for note in page.phonetic_notes %}
                <li><strong>{{ note.word }}</strong> - [Phonetic: {{ note.phonetic }}] (emphasis on {{ note.emphasis }})</li>
            {% endfor %}
            </ul>
            <p><em>{{ t_en.labels.guide_link }} <a href="{{ '/docs/user-guide' | relative_url }}?lang={{ lang }}">{{ t_en.labels.comprehensive_guide }}</a>.</em></p>
            {% endif %}
        </div>

        <h2><span data-lang="en">{{ t_en.sections.word_meanings }}</span><span data-lang="hi">{{ t_hi.sections.word_meanings }}</span></h2>
        <ul>
        {% for item in page.word_meanings %}
            <li><strong>{{ item.word }}</strong> ({{ item.roman }}) - {% if item.meaning.en %}<span data-lang="en">{{ item.meaning.en }}</span><span data-lang="hi">{{ item.meaning.hi }}</span>{% else %}{{ item.meaning }}{% endif %}</li>
        {% endfor %}
        </ul>

        <h2><span data-lang="en">{{ t_en.sections.literal_translation }}</span><span data-lang="hi">{{ t_hi.sections.literal_translation }}</span></h2>
        {% if page.literal_translation.en %}
        <div data-lang="en">
            <p>{{ page.literal_translation.en }}</p>
        </div>
        {% endif %}
        {% if page.literal_translation.hi %}
        <div data-lang="hi">
            <p>{{ page.literal_translation.hi }}</p>
        </div>
        {% endif %}

        <h2><span data-lang="en">{{ t_en.sections.interpretive_meaning }}</span><span data-lang="hi">{{ t_hi.sections.interpretive_meaning }}</span></h2>
        {% if page.interpretive_meaning.en %}
        <div data-lang="en">
            <p>{{ page.interpretive_meaning.en }}</p>
        </div>
        {% endif %}
        {% if page.interpretive_meaning.hi %}
        <div data-lang="hi">
            <p>{{ page.interpretive_meaning.hi }}</p>
        </div>
        {% endif %}

        <h2><span data-lang="en">{{ t_en.sections.story }}</span><span data-lang="hi">{{ t_hi.sections.story }}</span></h2>
        {% if page.story.en %}
        <div data-lang="en">
            <p>{{ page.story.en }}</p>
        </div>
        {% endif %}
        {% if page.story.hi %}
        <div data-lang="hi">
            <p>{{ page.story.hi }}</p>
        </div>
        {% endif %}

        <h2><span data-lang="en">{{ t_en.sections.practical_application }}</span><span data-lang="hi">{{ t_hi.sections.practical_application }}</span></h2>
        <p><strong><span data-lang="en">{{ t_en.labels.key_teaching }}</span><span data-lang="hi">{{ t_hi.labels.key_teaching }}</span>:</strong><br>
        {% if page.practical_application.teaching.en %}<span data-lang="en">{{ page.practical_application.teaching.en }}</span>{% endif %}{% if page.practical_application.teaching.hi %}<span data-lang="hi">{{ page.practical_application.teaching.hi }}</span>{% endif %}
        </p>

        <p><strong><span data-lang="en">{{ t_en.labels.when_to_use }}</span><span data-lang="hi">{{ t_hi.labels.when_to_use }}</span>:</strong><br>
        {% if page.practical_application.when_to_use.en %}<span data-lang="en">{{ page.practical_application.when_to_use.en }}</span>{% endif %}{% if page.practical_application.when_to_use.hi %}<span data-lang="hi">{{ page.practical_application.when_to_use.hi }}</span>{% endif %}
        </p>

        {% comment %} Puranic Context Boxes {% endcomment %}
        {% if page.puranic_context %}
        <section class="puranic-context-section">
            <h2 class="puranic-context-heading">
                <span data-lang="en">üìñ Puranic Context & Stories</span>
                <span data-lang="hi">üìñ ‡§™‡•å‡§∞‡§æ‡§£‡§ø‡§ï ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§î‡§∞ ‡§ï‡§π‡§æ‡§®‡§ø‡§Ø‡§æ‡§Ç</span>
            </h2>

            {% comment %} Separate contexts by priority {% endcomment %}
            {% assign high_priority = page.puranic_context | where: "priority", "high" %}
            {% assign medium_priority = page.puranic_context | where: "priority", "medium" %}
            {% assign low_priority = page.puranic_context | where: "priority", "low" %}

            {% comment %} High Priority Contexts - Always Visible {% endcomment %}
            {% if high_priority.size > 0 %}
            <div class="puranic-context-grid">
                {% for context in high_priority %}
                    {% include puranic-context-box.html context=context priority="high" %}
                {% endfor %}
            </div>
            {% endif %}

            {% comment %} Medium Priority Contexts - Expandable {% endcomment %}
            {% if medium_priority.size > 0 %}
            <div class="puranic-context-expandable">
                <button class="puranic-expand-toggle"
                        onclick="togglePuranicContexts(this)"
                        aria-expanded="false"
                        aria-controls="medium-priority-contexts">
                    <span class="expand-icon">‚ñ∂</span>
                    <span data-lang="en">Show {{ medium_priority.size }} More Context{% if medium_priority.size > 1 %}s{% endif %}</span>
                    <span data-lang="hi">{{ medium_priority.size }} ‡§î‡§∞ ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç</span>
                </button>
                <div id="medium-priority-contexts" class="puranic-context-grid context-collapsed">
                    {% for context in medium_priority %}
                        {% include puranic-context-box.html context=context priority="medium" %}
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            {% comment %} Low Priority Contexts - Expandable {% endcomment %}
            {% if low_priority.size > 0 %}
            <div class="puranic-context-expandable">
                <button class="puranic-expand-toggle"
                        onclick="togglePuranicContexts(this)"
                        aria-expanded="false"
                        aria-controls="low-priority-contexts">
                    <span class="expand-icon">‚ñ∂</span>
                    <span data-lang="en">Learn More ({{ low_priority.size }} Additional Context{% if low_priority.size > 1 %}s{% endif %})</span>
                    <span data-lang="hi">‡§î‡§∞ ‡§ú‡§æ‡§®‡•á‡§Ç ({{ low_priority.size }} ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠)</span>
                </button>
                <div id="low-priority-contexts" class="puranic-context-grid context-collapsed">
                    {% for context in low_priority %}
                        {% include puranic-context-box.html context=context priority="low" %}
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </section>
        {% endif %}

        <hr>

        <p><em><span data-lang="en">{{ t_en.labels.recitation_guidelines }}</span><span data-lang="hi">{{ t_hi.labels.recitation_guidelines }}</span> <a href="{{ '/docs/user-guide' | relative_url }}?lang={{ lang }}"><span data-lang="en">{{ t_en.labels.comprehensive_guide }}</span><span data-lang="hi">{{ t_hi.labels.comprehensive_guide }}</span></a>.</em></p>
    </div>

    <nav class="verse-nav bottom">
        {% if page.previous_verse %}
        <a href="{{ page.previous_verse | relative_url }}?lang={{ lang }}" class="nav-button prev">‚Üê <span data-lang="en">{{ t_en.nav.previous }}</span><span data-lang="hi">{{ t_hi.nav.previous }}</span></a>
        {% else %}
        <span class="nav-button prev disabled">‚Üê <span data-lang="en">{{ t_en.nav.previous }}</span><span data-lang="hi">{{ t_hi.nav.previous }}</span></span>
        {% endif %}

        <a href="{{ '/' | relative_url }}?lang={{ lang }}" class="nav-button home">‚ò∞ <span data-lang="en">{{ t_en.nav.home }}</span><span data-lang="hi">{{ t_hi.nav.home }}</span></a>

        {% if page.next_verse %}
        <a href="{{ page.next_verse | relative_url }}?lang={{ lang }}" class="nav-button next"><span data-lang="en">{{ t_en.nav.next }}</span><span data-lang="hi">{{ t_hi.nav.next }}</span> ‚Üí</a>
        {% else %}
        <span class="nav-button next disabled"><span data-lang="en">{{ t_en.nav.next }}</span><span data-lang="hi">{{ t_hi.nav.next }}</span> ‚Üí</span>
        {% endif %}
    </nav>
</article>

<script>
    // Store navigation URLs for arrow key navigation
    window.verseNav = {
        previous: "{{ page.previous_verse | relative_url }}?lang={{ lang }}",
        next: "{{ page.next_verse | relative_url }}?lang={{ lang }}"
    };

    // Toggle Puranic Context sections
    function togglePuranicContexts(button) {
        const isExpanded = button.getAttribute('aria-expanded') === 'true';
        const targetId = button.getAttribute('aria-controls');
        const targetSection = document.getElementById(targetId);

        if (targetSection) {
            if (isExpanded) {
                // Collapse
                targetSection.classList.remove('context-expanded');
                targetSection.classList.add('context-collapsed');
                button.setAttribute('aria-expanded', 'false');
            } else {
                // Expand
                targetSection.classList.remove('context-collapsed');
                targetSection.classList.add('context-expanded');
                button.setAttribute('aria-expanded', 'true');
            }
        }
    }
</script>
